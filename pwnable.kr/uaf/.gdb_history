r 1 uaf.cpp
r 1 magic
r 100 magic
r 16 magic
print/x $epx
print/x $ebx
print/x $eip
print $eip
x/i $eip
ls
r 16 magic
r 16 magic
sizeof(Man)
print sizeof(Man)
print sizeof(0x0000000000401149)
print sizeof(*0x0000000000401149)
r 16 magic
disas main
disassemble main
b read
r 16 magic
c
c
c
c
c
b
qut
quit
info locals
r 100 magic
r 100 magic
info stack
print sizeof(int)
print sizeof(char)
print sizeof(Man)
x/x 0xfbad2a84
hex 0xfbad2a84
hexdump 0xfbad2a84
hexdump *0xfbad2a84
sizeof(pointer)
print sizeof(pointer)
print sizeof(int *)
print sizeof(char *)
print sizeof(float *)
print sizeof(int) + sizeof(char *) + sizeof(char *) + sizeof(char *)
r 28 magic
exit
quit
r 48 magic
quit
r 48 magic
r 48 magic
disassemble main
r 48 magic
ddd
quit
disass main
print sizeof(m)
print sizeof(*m)
run 
print sizeof(*m)
print sizeof(Man)
print sizeof(Woman)
r 48 magic
r 48 magic
hexdump *0x00000000004011b7
hexdump 20 *0x00000000004011b7
hexdump/20 *0x00000000004011b7
hexdump 0x00000000004011b7
hexdump 20 0x00000000004011b7
hexdump 0x00000000004011b7
hexdump 0x00000000004011f7
hexdump 0x0000000000401137
hexdump 0x0000000000401177
hexdump 0x00000000004011b7
hexdump 0x00000000004011f7
hexdump 0x0000000000401237
hexdump 0x0000000000401277
hexdump 0x00000000004012b7
hexdump 0x00000000004012f7
hexdump 0x0000000000401337
clear
b *0x7ffff756c680
r
1
r
1
c
r
c
quit
r 48 magic
0x4011b7
b *0x4011b7
c
x/x rax
x/x $rax
c
x/x $rax
c
x/x *0x004014b8
x/x 0x004014b8
r
r 48 magic
c
x/x 0x004014b8
x/x 0xe5894855
r
c
r
1
c
i r rax
x/c 0x44
print/c 0x44
print/c 0x42
print/c 0x4225
print/c 0x41
print/c 0x49
r 48 magic
c
i r rax
x/c rax
x/c $rax
print/s $rax
print $rax
x/s $rax
print rax
print $rax
print/s $rax
print/c $rax
print/20s $rax
print/c $rax
print/c $rax + 4
print/c $rax + 1
print/c $rax + 2
print/c $rax + 3
print/c $rax + 4
quit
disassemble main
b *0x00000000004011ed
r
b *0x00000000004011c1
r
r
